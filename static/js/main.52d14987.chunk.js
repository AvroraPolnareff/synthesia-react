(this["webpackJsonpsynthesia-react"]=this["webpackJsonpsynthesia-react"]||[]).push([[0],{137:function(t,n,e){},151:function(t,n,e){"use strict";e.r(n);var i,r,c,s,a,o,u,d=e(0),f=e.n(d),l=e(20),p=e.n(l),h=(e(137),e(12)),b=e.n(h),j=e(21),g=e(8),m=e(9),x=e(13),k=e(2),v=e(3),O=e(1),y=Object(v.b)((function(t){var n=t.className;return Object(O.jsx)("div",{className:n})}))(i||(i=Object(k.a)(["\n  box-sizing: border-box;\n  width: 20px;\n  height: 100%;\n  padding: 2px;\n  background: "," ","\n"])),(function(t){return t.pressed?"#c9c9c9":"#f6f6f6"}),(function(t){return t.black&&Object(v.a)(r||(r=Object(k.a)(["\n    width: 12px;\n    background: ","\n  "])),(function(t){return t.pressed?"#2d2d2d":"#505050"}))})),T=function(t){return[1,3,6,8,10].some((function(n){return n===t%12}))},P=Array.from(Array(127),(function(t,n){return T(n)})),S=Object(v.b)((function(t){var n=t.className,e=t.start,i=void 0===e?48:e,r=t.end,c=void 0===r?71:r,s=t.pressedKeys,a=void 0===s?[48,50,52]:s,o=P.map((function(t,n){return{index:n,black:t,pressed:a.some((function(t){return t===n}))}})).slice(i,c+1);return Object(O.jsx)("div",{className:n,children:o.map((function(t){return Object(O.jsx)(y,{black:t.black,pressed:t.pressed},t.index)}))})}))(c||(c=Object(k.a)(["\n  height: 50px;\n  display: flex;\n"]))),w=e(25),L=e(26),N=e(27),C=e(28),F={isPlaying:!1,currentNotes:[],notes:[],currentTick:0,tickLength:0},I=function(){function t(n){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(L.a)(this,t),this.midi=n,this.trackToPlay=i,this.speed=r,this.tempo=this.midi.header.tempos[0].bpm,this.currentTick=0,this.isPlaying=!1,this.listeners=[],this.timer=void 0,this.deltaframe=new C.a({minFps:30,targetFps:144}),this.state=F,this.nextState=function(){var t=e.midi.tracks[e.trackToPlay].notes.map((function(t){var n=t.midi,i=t.durationTicks;return{note:n,position:t.ticks-e.currentTick,length:i}})),n=t.filter((function(t){return t.position<=0&&-1*t.position<=t.length}));return e.isPlaying&&e.currentTick++,e.currentTick===e.midi.tracks[e.trackToPlay].endOfTrackTicks&&e.stop(),{currentTick:e.currentTick,notes:t,currentNotes:n,isPlaying:e.isPlaying,tickLength:e.tickLength}},this.passStateToListeners=function(t){e.listeners.forEach((function(n){return n(t)}))},this.onStateChange=function(t){e.listeners.push(t),e.passStateToListeners(e.nextState())},this.play=function(){e.isPlaying=!0,e.timer=setInterval((function(){e.state=e.nextState()}),e.tickLength),e.deltaframe.start((function(t,n){e.passStateToListeners(e.state)}))},this.pause=function(){e.isPlaying&&(e.isPlaying=!1,e.timer&&clearInterval(e.timer)),e.passStateToListeners(e.nextState())},this.stop=function(){e.currentTick=0,e.pause()}}return Object(N.a)(t,[{key:"tickLength",get:function(){return 60/this.tempo/this.midi.header.ppq*this.speed*1e3}}]),t}(),z=e(6),E=e(29),A=v.b.div(s||(s=Object(k.a)(["\n  position: absolute;\n  width: 100%;\n  background: #ff7878;\n  bottom: ","px;\n  height: ","px;\n"])),(function(t){return t.position}),(function(t){return t.size})),D=v.b.div(a||(a=Object(k.a)(["\n  position: relative;\n  box-sizing: border-box;\n  width: 20px;\n  height: 100%;\n  border: solid 1px #989797;\n  background: "," ","\n  overflow: no-display;\n"])),(function(t){return t.pressed?"#c9c9c9":"#f6f6f6"}),(function(t){return t.black&&Object(v.a)(o||(o=Object(k.a)(["\n    width: 12px;\n    background: ","\n  "])),(function(t){return t.pressed?"#b2b2b2":"#dedede"}))})),M=function(t,n,e){var i,r=Array(e-n+1).fill([]),c=Object(E.a)(t);try{for(c.s();!(i=c.n()).done;){var s=i.value,a=s.note-n;r.length>a&&(r[a]=[].concat(Object(g.a)(r[a]),[s]))}}catch(o){c.e(o)}finally{c.f()}return r},B=Object(v.b)((function(t){var n=t.notes,e=void 0===n?[]:n,i=t.className,r=t.start,c=void 0===r?48:r,s=t.end,a=void 0===s?71:s;return Object(O.jsx)("div",{className:i,children:M(e,c,a).map((function(t,n){return Object(O.jsx)(D,{black:T(n+c),children:t.map((function(t){return Object(O.jsx)(A,{position:t.position,size:t.length})}))})}))})}))(u||(u=Object(k.a)(["\n  height: 300px;\n  display: flex;\n  overflow: hidden;\n"]))),J=function(t){var n=t.track,e=void 0===n?1:n,i=function(){var t=Object(d.useState)(z.a.none),n=Object(m.a)(t,2),e=n[0],i=n[1],r=function(){var t=Object(j.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.Midi.fromUrl("/".concat("synthesia-react/","example2.mid"));case 2:n=t.sent,i(z.a.some(n));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(d.useEffect)((function(){r()}),[]),e}();return z.a.map((function(t){return new I(t,e,.5)}))(i)},K=function(t){var n=t.player,e=Object(d.useState)(F),i=Object(m.a)(e,2),r=i[0],c=i[1],s=r.currentNotes,a=r.isPlaying,o=r.notes;return Object(d.useEffect)((function(){return n.onStateChange(c)}),[n]),Object(O.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(O.jsx)(B,{notes:o}),Object(O.jsx)(S,{pressedKeys:s.map((function(t){return t.note}))}),Object(O.jsx)("button",{onClick:a?n.stop:n.play,children:a?"stop":"play"})]})},q=function(){Object(x.useMIDI)();var t=J({track:1});return z.a.match((function(){return Object(O.jsx)("div",{children:"loading..."})}),(function(t){return Object(O.jsx)(K,{player:t})}))(t)},U=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,152)).then((function(n){var e=n.getCLS,i=n.getFID,r=n.getFCP,c=n.getLCP,s=n.getTTFB;e(t),i(t),r(t),c(t),s(t)}))};p.a.render(Object(O.jsx)(f.a.StrictMode,{children:Object(O.jsx)(q,{})}),document.getElementById("root")),U()}},[[151,1,2]]]);
//# sourceMappingURL=main.52d14987.chunk.js.map